<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, viewport-fit=cover"/>
  <meta name="theme-color" content="#000000"/>
  <title>ByAgent Terminal</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <!-- TradingView Advanced Chart -->
  <script src="https://s3.tradingview.com/tv.js"></script>
  <!-- Main CSS -->
  <link rel="stylesheet" href="src/styles/components.css">
  <style>
    /* --- Layout & theme (mobile-friendly) --- */
    html, body { height:auto; min-height:100%; -webkit-text-size-adjust:100%; }
    :root{
      --bg0:#000000; --bg1:#0a0a0a; --bg2:#151515;
      --card:#1a1a1a; --muted:#a0a0a0; --text:#e0e0e0;
      --border:#404040;
      --green:#22c55e; --red:#ef4444; --blue:#38bdf8;
      --silver:#c0c0c0; --metal:#8a8a8a;
    }
    body{
      margin:0; color:var(--text);
      background:
        radial-gradient(1200px 600px at 60% -12%, rgba(128,128,128,.08), transparent 55%),
        radial-gradient(900px 520px at 5% 15%, rgba(96,96,96,.06), transparent 60%),
        linear-gradient(180deg, #0a0a0a, #000000);
      font-family: ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Helvetica Neue,Arial;
    }
    .wrap{max-width:1220px; margin:8px auto; padding:0 12px 28px;}
    .card{
      background:linear-gradient(135deg, rgba(64,64,64,.15), rgba(32,32,32,.1));
      border:1px solid var(--border); border-radius:16px; padding:10px;
      box-shadow:0 10px 40px rgba(0,0,0,.6), inset 0 0 0 1px rgba(192,192,192,.08);
    }
    .row{display:flex; gap:8px; flex-wrap:wrap; align-items:center;}
    .spacer{flex:1 1 auto;}
    .input{
      flex:1 1 260px; background:#0a0a0a; border:1px solid var(--border);
      color:#e0e0e0; border-radius:12px; padding:12px; outline:none;
      box-shadow:inset 0 0 0 1px rgba(192,192,192,.15);
    }
    .input:focus{ border-color: var(--silver); box-shadow:0 0 0 2px var(--silver), inset 0 0 0 1px rgba(192,192,192,.35); }
    .btn{
      background:linear-gradient(90deg, #0a0a0a 0%, #2a2a2a 25%, #3a3a3a 50%, #2a2a2a 75%, #0a0a0a 100%);
      background-size: 300% 100%;
      color:#e0e0e0; border:2px solid rgba(192,192,192,.5);
      border-radius:14px; padding:11px 12px; cursor:pointer; user-select:none; text-align:center;
      box-shadow:0 0 0 1px rgba(192,192,192,.3), 0 0 12px rgba(192,192,192,.2), inset 0 0 0 1px rgba(192,192,192,.15);
      transition: transform .14s ease;
      white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
      animation: shimmerFlow 6s ease-in-out infinite, borderPulse 6s ease-in-out infinite, glowPulse 6s ease-in-out infinite;
    }
    .btn:hover{ transform: translateY(-2px); filter: brightness(1.15); border-color: var(--silver); box-shadow: 0 0 0 1px var(--silver), 0 0 15px rgba(192,192,192,.5), inset 0 0 0 1px rgba(192,192,192,.3); }

    @keyframes shimmerFlow {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    @keyframes borderPulse {
      0%, 100% { border-color: rgba(192,192,192,.4); }
      50% { border-color: rgba(220,220,220,.7); }
    }

    @keyframes glowPulse {
      0%, 100% { box-shadow:0 0 0 1px rgba(192,192,192,.3), 0 0 12px rgba(192,192,192,.2), inset 0 0 0 1px rgba(192,192,192,.15); }
      50% { box-shadow:0 0 0 1px rgba(192,192,192,.5), 0 0 20px rgba(192,192,192,.4), inset 0 0 0 1px rgba(192,192,192,.3); }
    }
    .seg{display:flex; gap:6px; padding:4px; border-radius:12px; background:#0a0a0a; border:1px solid var(--border); flex-wrap:wrap}
    .seg button{
      background:linear-gradient(90deg, transparent 0%, rgba(64,64,64,.1) 25%, rgba(96,96,96,.2) 50%, rgba(64,64,64,.1) 75%, transparent 100%);
      background-size: 300% 100%;
      color:#c0c0c0; border:2px solid rgba(192,192,192,.3); padding:6px 10px; border-radius:10px; cursor:pointer;
      animation: shimmerFlow 6s ease-in-out infinite, borderPulse 6s ease-in-out infinite;
    }
    .seg button.active{
      background:linear-gradient(90deg, rgba(96,96,96,.2) 0%, rgba(160,160,160,.3) 25%, rgba(192,192,192,.4) 50%, rgba(160,160,160,.3) 75%, rgba(96,96,96,.2) 100%);
      background-size: 300% 100%;
      color:#fff; border:2px solid rgba(192,192,192,.6);
      box-shadow:inset 0 0 0 1px rgba(192,192,192,.4), 0 0 15px rgba(192,192,192,.3);
      animation: shimmerFlow 6s ease-in-out infinite, activeGlowPulse 6s ease-in-out infinite, activeBorderPulse 6s ease-in-out infinite;
    }

    @keyframes activeGlowPulse {
      0%, 100% { box-shadow:inset 0 0 0 1px rgba(192,192,192,.4), 0 0 15px rgba(192,192,192,.3); }
      50% { box-shadow:inset 0 0 0 1px rgba(192,192,192,.6), 0 0 25px rgba(192,192,192,.5); }
    }

    @keyframes activeBorderPulse {
      0%, 100% { border-color: rgba(192,192,192,.6); }
      50% { border-color: rgba(220,220,220,.9); }
    }

    .badge{
      border:1px solid var(--border); background:linear-gradient(180deg, #1a1a1a, #0f0f0f);
      border-radius:12px; padding:6px 10px; color:#c0c0c0;
      box-shadow:inset 0 0 0 1px rgba(192,192,192,.12);
    }
    .mini{font-size:12px; color:#a0a0a0;}
    .mono{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Courier New", monospace;}

    /* "Pill" badges row like screenshot */
    .pills{display:flex; flex-wrap:wrap; gap:8px; margin-top:8px;}
    .pill{border:1px solid var(--border); border-radius:12px; padding:6px 10px; background:#0a0a0a; color:var(--silver); box-shadow:inset 0 0 0 1px rgba(192,192,192,.12);}
    .pill .k{opacity:.75; margin-right:4px}

    /* Agent header to match screenshot */
    .agentHead{display:flex; align-items:center; gap:8px; margin-bottom:6px;}
    .dot{width:10px; height:10px; border-radius:50%; display:inline-block; background:var(--blue)}
    .h1{font-weight:800; letter-spacing:.4px}
    .sym{font-weight:800;}

    .ul-stat{list-style:none; padding-left:0; margin:10px 0 4px 0;}
    .ul-stat li{display:flex; align-items:center; gap:8px; margin:6px 0}
    .ul-stat li .bullet{width:6px; height:6px; border-radius:50%; background:#cbd5e1; display:inline-block}
    .ul-stat li .label{min-width:62px; opacity:.85}

    /* chart */
    #chartWrap{height:560px; border:1px solid var(--border); border-radius:14px; overflow:hidden; background:#000000; position:relative; margin-top:8px;}
    #tvchart{height:100%;}

    /* colors */
    .n-blue{ color:var(--blue); }
    .n-green{ color:var(--green); }
    .n-red{ color:var(--red); }

    /* Drawer (for future modules) */
    .drawer { position:absolute; inset:0; background: rgba(10, 10, 10, .96); border-radius: 14px; display:none; flex-direction: column; z-index: 10; opacity: 0; transform: translateY(40px); transition: opacity 0.3s ease, transform 0.3s ease; backdrop-filter: blur(8px); -webkit-backdrop-filter: blur(8px); border: 1px solid var(--border); box-shadow: 0 0 20px rgba(0,0,0,.8); }
    .drawer.show { display:flex; opacity: 1; transform: translateY(0); }
    .drawer.closing { opacity: 0; transform: translateY(60px); }
    .drawer .head { display:flex; align-items:center; justify-content:space-between; padding:12px 16px; border-bottom:1px solid var(--border); gap:8px; background: rgba(64,64,64,.1); }
    .drawer .title { font-size:18px; font-weight:800; color: var(--text); }
    .drawerBody { padding:16px; overflow:auto; height:100%; scroll-behavior:smooth; -webkit-overflow-scrolling: touch; }
  </style>
</head>
<body>
<div class="wrap">

  <!-- SEARCH -->
  <div class="card">
    <div class="row">
      <input id="sym" class="input mono" list="symList" placeholder="Поиск: BTC (авто → BTCUSDT) / BTCUSDT" spellcheck="false"/>
      <datalist id="symList"></datalist>
      <button class="btn" id="btnFind">Найти</button>
    </div>

    <div class="btn-group-top" style="display:flex; gap:8px; margin-top:8px;">
      <button class="btn" id="btnWallet">Wallet</button>
      <button class="btn" id="btnAlerts">Алерты</button>
    </div>

    <div class="neon-wrap" style="display:grid; grid-template-columns:1fr 1fr; gap:8px; margin-top:8px;">
      <button class="btn" data-module="copytrading">Копитрейдинг</button>
      <button class="btn" data-module="spreads">Спреды</button>
      <button class="btn" data-module="defi">DeFi</button>
      <button class="btn" data-module="signals">Сигналы 10x</button>
      <button class="btn" data-module="favorites">⭐ Избранное</button>
      <button class="btn" data-module="app-yield">Доходность App</button>
      <button class="btn" data-module="setups">Сетапы</button>
      <button class="btn" data-module="anomalies">Аномалии</button>
      <button class="btn" data-module="movers">Топ рост/падение</button>
      <button class="btn" data-module="listings">Листинги</button>
    </div>
  </div>

  <!-- AGENT (visual like screenshot) -->
  <div class="card" style="margin-top:10px;">
    <div class="row" style="align-items:center;">
      <div class="agentHead">
        <span id="agentDot" class="dot"></span>
        <span id="agentStateTxt" class="h1 mono n-blue">FLAT</span>
      </div>
      <div class="spacer"></div>
      <div class="seg" id="autoSeg">
        <button class="active" data-sec="5">5s</button>
        <button data-sec="10">10s</button>
        <button data-sec="15">15s</button>
      </div>
    </div>

    <div style="margin-top:6px;">
      <div id="agentSym" class="mono sym n-blue">BTCUSDT</div>
    </div>

    <ul class="ul-stat">
      <li><span class="bullet"></span><span class="label mono">Entry:</span><span id="entryV" class="mono n-blue">—</span></li>
      <li><span class="bullet"></span><span class="label mono">TP:</span><span id="tpV" class="mono n-green">—</span></li>
      <li><span class="bullet"></span><span class="label mono">SL:</span><span id="slV" class="mono n-red">—</span></li>
    </ul>

    <div class="pills">
      <div class="pill"><span class="k mono">Сигнал:</span><span id="sidePill" class="mono">—</span></div>
      <div class="pill"><span class="k mono">Auto:</span><span id="autoLbl" class="mono">5s</span></div>
      <div class="pill"><span class="k mono">Цена:</span><span id="lastV" class="mono n-blue">—</span></div>
      <div class="pill"><span class="k mono">RSI14:</span><span id="rsiV" class="mono">—</span></div>
      <div class="pill"><span class="k mono">EMA50:</span><span id="ema50V" class="mono">—</span></div>
      <div class="pill"><span class="k mono">EMA200:</span><span id="ema200V" class="mono">—</span></div>
      <div class="pill"><span class="k mono">MACD:</span><span id="macdV" class="mono">—</span></div>
      <div class="pill"><span class="k mono">ATR:</span><span id="atrV" class="mono">—</span></div>
      <div class="pill"><span class="k mono">RR:</span><span id="rrV" class="mono">—</span></div>
      <div class="pill"><span class="k mono">Conf:</span><span id="confV" class="mono">—</span></div>
      <div class="pill"><span class="k mono">WS:</span><span id="wsState" class="mono">offline</span></div>
    </div>

    <div id="chartWrap">
      <div id="tvchart"></div>
      <div class="drawer" id="drawer">
        <div class="head">
          <div class="title" id="drawerTitle">—</div>
          <button class="btn" id="drawerClose" style="background:none; border:2px solid var(--border); color:var(--silver); padding:8px 12px; border-radius:10px; box-shadow:0 0 10px rgba(0,0,0,.5); transition: all .14s ease;">Закрыть</button>
        </div>
        <div class="drawerBody" id="drawerBody"></div>
      </div>
    </div>
  </div>

  <!-- OPEN INTEREST -->
  <div class="card" id="oiCard" style="margin-top:10px;">
    <div class="row" style="justify-content:space-between; align-items:center">
      <div class="heading" id="oiHeader" style="margin:0">
        Open Interest — <span id="oiTitleSym">BTCUSDT</span>
        <span id="oiHint" class="mini mono n-blue" style="margin-left:8px;">—</span>
      </div>
      <div class="seg" id="oiSeg">
        <button class="active" data-int="5min">5m</button>
        <button data-int="15min">15m</button>
        <button data-int="30min">30m</button>
        <button data-int="1h">1h</button>
        <button data-int="4h">4h</button>
      </div>
    </div>
    <div class="mini" style="margin-top:8px;">Taker Buy: <span class="mono" id="takerBuy">—</span></div>
    <div class="mini">Taker Sell: <span class="mono" id="takerSell">—</span></div>
    <div class="mini">Open Interest: <span class="mono" id="oiNow">—</span></div>
    <div class="mini">ΔOI: <span class="mono" id="oiDelta">—</span></div>
    <div class="mini">ΔOI %: <span class="mono" id="oiDeltaPct">—</span></div>
    <div class="mini">Funding Rate: <span class="mono" id="fundingNow">—</span></div>
    <div class="mini muted" id="oiUpdated">Обновлено: —</div>
  </div>
</div>

<!-- Main Application Script -->
<script type="module" src="src/main.js"></script>
</body>
</html>
